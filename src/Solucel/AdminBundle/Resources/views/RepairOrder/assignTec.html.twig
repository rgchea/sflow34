{% extends 'SolucelAdminBundle::layout.html.twig' %}

{% block breadcrumb %}
    {{ parent() }}
    
    {% endblock %}

{% block title %}
    Asignación
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    
    <script src="{{ asset('bundles/pizotearkadmin/js/plugin/datatables/jquery.dataTables-cust.js') }}"></script>
    <script src="{{ asset('bundles/pizotearkadmin/js/plugin/datatables/ColReorder.min.js') }}"></script>
    <script src="{{ asset('bundles/pizotearkadmin/js/plugin/datatables/FixedColumns.min.js') }}"></script>
    <script src="{{ asset('bundles/pizotearkadmin/js/plugin/datatables/ColVis.min.js') }}"></script>
    <script src="{{ asset('bundles/pizotearkadmin/js/plugin/datatables/ZeroClipboard.js') }}"></script>
    <script src="{{ asset('bundles/pizotearkadmin/js/plugin/datatables/media/js/TableTools.min.js') }}"></script>
    <script src="{{ asset('bundles/pizotearkadmin/js/plugin/datatables/DT_bootstrap.js') }}"></script>
    
{% endblock %}


{% block body -%}
{{ parent() }}

<div class="row">
    <div class="col-xs-12 col-sm-7 col-md-7 col-lg-4">

    </div>

</div>

<div class="jarviswidget jarviswidget-color-darken" id="wid-id-0" data-widget-editbutton="false">
    <header>
        <h2> Listado de Técnicos a asignar Ordenes</h2>
    </header>

    <!-- widget div-->
    <div>
		<div class="progress progress-striped">
			<div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 66%;">
				<span class="sr-only">66% Complete</span>
			</div>
		</div> 
            
        <form id="tecForm" action="{{path('solucel_admin_repairorder_assigntec')}}" method="POST" name="solucel_admin_repairorder_assigntec">
        	<input type="hidden" name="assign_tec" value="true" />
        	<input type="hidden" name="service_center" value="{{app.request.get('select_service_center')}}" />
            <fieldset>
			
				<input type="hidden" name="orders" value="{{orders}}" />
				<button class="btn btn-primary" onclick="">Aceptar</button>
		        <!-- widget edit box -->
		        <div class="jarviswidget-editbox">
		            <!-- This area used as dropdown edit box -->
		
					<br />
											
		        </div>
		        <!-- end widget edit box -->
		
		        <!-- widget content -->
		        <div class="widget-body no-padding">
		            <div class="widget-body-toolbar">
		
		            </div>
		
		            <table id="dt_basic" class="table table-striped table-bordered table-hover">
		                <thead>
		                    <tr>
		                    	<th>Técnico</th>
		                    	<th>Nombre</th>
		                    	<th>Apellido</th>
		                    	<th>Acciones</th>
		                    </tr>
		                </thead>
		                <tbody>
		                {% set tecs_count = 0 %}
		                {% for entity in tecs %}
		                    <tr id="tr_{{entity.id}}">
		                        <td>{{ entity.username }}</td>
		                        <td>{{ entity.name }}</td>
		                        <td>{{ entity.lastName }}</td>
		                        <td align="right">
		                        	<a class="btn btn-danger btn-delete" href="#" onclick="removeTec({{entity.id}})">
										<i class="fa fa-trash-o"></i>
									</a>
		                        </td>
		                        <input type="hidden" id="tec_{{entity.id}}" name="tec[{{entity.id}}]" />
		                    </tr>
		                    {% set tecs_count = tecs_count + 1 %}
		                {% endfor %}
		                
		                </tbody>
		            </table>
		
		
		        </div>
		        <!-- end widget content -->
				
			</fieldset>
		</form>
    </div>
    <!-- end widget div -->
</div>    



<script>
	
	$( document ).ready(function() {
	    
	    
	    
	});
		
	var countTecs = "{{tecs_count}}";
	
	
	function removeTec(tecID){
		
	    var c = confirm('Está seguro?');
	
	    if(c){
	    	countTecs = countTecs - 1;
	    	if(countTecs >= 1){
		    	$('#tec_'+tecID).remove();
		    	$('#tr_'+tecID).remove();
		    		    		
	    	}
	    	else{
	    		alert("Debe de haber por lo menos un técnico en el listado");
	    		return false;
	    	}
	    }else{
	    	return false;
	    }

				
	}
	
</script>

{% endblock %}


{% block extrascripts %}

	$("#created_from").datepicker();
	$("#created_to").datepicker();

    $('#dt_basic').dataTable({
	    "sPaginationType" : "bootstrap_full",
	    "aaSorting": [[ 0, "asc" ]],
	    "lengthMenu": [ [10, 25, 50, 100, -1], [10, 25, 50, 100,"Todos"] ],
	    "iDisplayLength": -1,
        "language": {
            "url": "{{ asset('bundles/pizotearkadmin/js/plugin/datatables/dataTables.spanish.lang') }}"
        }	    
    });



    

{% endblock %}

