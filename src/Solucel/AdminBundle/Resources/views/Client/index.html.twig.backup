{% extends 'WbcSmartAdminBundle::layout.html.twig' %}

{% block breadcrumb %}
    {{ parent() }}
    <li> <a href="{{ path('user') }}">Listado de Usuarios</a> </li>
    {% endblock %}

{% block title %}
    User list
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('bundles/wbcsmartadmin/js/plugin/datatables/jquery.dataTables-cust.min.js') }}"></script>
    <script src="{{ asset('bundles/wbcsmartadmin/js/plugin/datatables/ColReorder.min.js') }}"></script>
    <script src="{{ asset('bundles/wbcsmartadmin/js/plugin/datatables/FixedColumns.min.js') }}"></script>
    <script src="{{ asset('bundles/wbcsmartadmin/js/plugin/datatables/ColVis.min.js') }}"></script>
    <script src="{{ asset('bundles/wbcsmartadmin/js/plugin/datatables/ZeroClipboard.js') }}"></script>
    <script src="{{ asset('bundles/wbcsmartadmin/js/plugin/datatables/media/js/TableTools.min.js') }}"></script>
    <script src="{{ asset('bundles/wbcsmartadmin/js/plugin/datatables/DT_bootstrap.js') }}"></script>
    
    <script src="{{ asset('bundles/wbcsmartadmin/js/JQueryMultifilter/multifilter.js') }}"></script>
    

{% endblock %}


{% block body -%}
{{ parent() }}


    <style>
    	.input-group, .select{
    		position:relative !important;
    		top:-120px !important;
    	}
    	
    </style> 

<div id="spinner" class="spinner" style="display:none;"></div>    
<div class="row">
    <div class="col-xs-12 col-sm-7 col-md-7 col-lg-4">
        <h1 class="page-title txt-color-blueDark">
            <i class="fa fa-user fa-fw "></i> 
            Listado de Usuarios
        </h1>
    </div>
    <div class="col-xs-12 col-sm-5 col-md-5 col-lg-8">
        {% if is_granted('ROLE_ADMIN') %}
        <a class="pull-right btn btn-primary btn-lg" href="{{ path('user_new') }}">
            Crear Usuario
        </a>
        {% endif %}
    </div>
</div>

<div class="jarviswidget jarviswidget-color-darken" id="wid-id-0" data-widget-editbutton="false">
    <header>
        <h2> Listado de Usuarios </h2>
    </header>


    <!-- widget div-->
    <div>

        <!-- widget edit box -->
        <div class="jarviswidget-editbox">
            <!-- This area used as dropdown edit box -->

        </div>
        <!-- end widget edit box -->
		
        <!-- widget content -->
        
        <div class="widget-body no-padding">
        	
        	<div class="customSearch">
        		<div class="customFiltersTittles">Filtro general:</div>
		        <div class="customFiltersTittlesPages">Filtros por p√°gina:</div> 
	            <div class="widget-body-toolbar" style="position: relative; top: 100px">
	            
					<form action="" method="post" class="searchForm">
	                   
	                    <fieldset>
	                       
	                        <div class="form-group col-md-6">
								<div class='filter-container'>
									<input autocomplete='off' class='filter' name='Username' placeholder='Username' data-col='Username'/>	
								</div>	                        	
	                        </div> 

	                        <div class="form-group col-md-6">
								<div class='filter-container'>
									<input autocomplete='off' class='filter' name='Email' placeholder='Email' data-col='Email'/>	
								</div>
							</div> 
	                        <div class="form-group col-md-6">
								<div class='filter-container'>
									<input autocomplete='off' class='filter' name='Roles' placeholder='Roles' data-col='Roles'/>	
								</div>                     	
	                        </div> 
	                        <div class="form-group col-md-6">
								<div class='filter-container'>
									<input autocomplete='off' class='filter' name='Enabled' placeholder='Enabled' data-col='Enabled'/>	
								</div>		                        	
	                        </div> 
							<div class='clearfix'></div>
	
	                    </fieldset>
                    </form>        

            	
            	</div>
			</div>

			<table id="dt_basic" class="table table-striped table-bordered table-hover" style="margin-top: 80px">
		
		       {{ addDataTable(columns, {
		        'path':          path('user_load_ajax'),
		        'bLengthChange': 1,
		        'bInfo':         1,
		        'bFilter':       1,
		        "iDisplayLength": 10,
				"sPaginationType" : "bootstrap_full",
	    		"aaSorting": [[ 2, "asc" ]],
 				 
                		    				        
		        }) }}    
	                    
            </table>

    	</div>

	</div>
        <!-- end widget content -->

</div>
           
  
    <!-- end widget div -->

{% endblock %}

{% block extrascripts %}

	jQuery.ajax({ async: false});

	//cargar el filtro por columna
	$(document).ready(function() {
      	$(".filter").multifilter();
      	

	});	

	//cargar el filtro por columna cada vez que se re-dibuja la tabla via ajax por el filtro principal de datatables
	$(document).ajaxSuccess(function() {
	  $(".filter").multifilter();
	  
	});
		
    $(document).on('click', '.btn-delete', function(e){
    	e.preventDefault();

	    var url = $(this).attr('href'); 
	    var c = confirm('Are you sure of delete this user? This will delete all user data too.');
	
	    if(c){
	    	$('#spinner').show();
	    	window.location = url;
	    }else{
	    	return false;
	    }


    });

{% endblock %}